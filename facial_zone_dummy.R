source("cleaning_and_code_conversion.R")

## Data cleaning, dummy variables

## Creating mandible dummy variable
mmc_data$mandible <- ifelse(startsWith(mmc_data$ICD10.diagnosis.codes.1, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.2, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.3, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.4, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.5, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.6, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.7, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.8, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.9, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.10, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.12, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.13, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.14, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.15, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.16, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.17, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.18, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.19, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.20, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.21, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.22, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.23, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.24, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.25, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.26, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.27, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.28, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.29, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.30, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.31, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.32, "S02.6") | startsWith(mmc_data$ICD10.diagnosis.codes.33, "S02.6"), 1, 0)

## Creating superior dummy variable
mmc_data$superior <- ifelse(startsWith(mmc_data$ICD10.diagnosis.codes.1, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.2, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.3, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.4, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.5, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.6, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.7, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.8, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.9, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.10, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.12, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.13, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.14, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.15, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.16, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.17, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.18, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.19, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.20, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.21, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.22, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.23, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.24, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.25, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.26, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.27, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.28, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.29, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.30, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.31, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.32, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.33, "S02.19") | startsWith(mmc_data$ICD10.diagnosis.codes.1, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.2, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.3, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.4, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.5, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.6, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.7, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.8, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.9, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.10, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.12, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.13, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.14, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.15, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.16, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.17, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.18, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.19, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.20, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.21, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.22, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.23, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.24, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.25, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.26, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.27, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.28, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.29, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.30, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.31, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.32, "S02.12") | startsWith(mmc_data$ICD10.diagnosis.codes.33, "S02.12"), 1, 0)

## Creating midface dummy variable for first two ICD10 codes
mmc_data$midface <- ifelse(startsWith(mmc_data$ICD10.diagnosis.codes.1, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.2, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.3, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.4, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.5, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.6, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.7, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.8, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.9, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.10, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.12, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.13, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.14, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.15, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.16, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.17, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.18, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.19, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.20, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.21, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.22, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.23, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.24, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.25, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.26, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.27, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.28, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.29, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.30, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.31, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.32, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.33, "S02.2") | startsWith(mmc_data$ICD10.diagnosis.codes.1, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.2, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.3, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.4, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.5, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.6, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.7, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.8, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.9, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.10, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.12, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.13, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.14, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.15, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.16, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.17, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.18, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.19, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.20, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.21, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.22, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.23, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.24, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.25, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.26, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.27, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.28, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.29, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.30, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.31, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.32, "S02.3") | startsWith(mmc_data$ICD10.diagnosis.codes.33, "S02.3"), 1, 0)

## Creating midface dummy varaible for final ICD10 code
mmc_data$midface2 <- ifelse(startsWith(mmc_data$ICD10.diagnosis.codes.1, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.2, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.3, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.4, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.5, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.6, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.7, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.8, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.9, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.10, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.12, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.13, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.14, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.15, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.16, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.17, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.18, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.19, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.20, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.21, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.22, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.23, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.24, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.25, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.26, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.27, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.28, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.29, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.30, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.31, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.32, "S02.4") | startsWith(mmc_data$ICD10.diagnosis.codes.33, "S02.4"), 1, 0)

## Combining midface and midface2 dummy variables
mmc_data$midface.true <- ifelse(mmc_data$midface == 1 | mmc_data$midface2 == 1, 1, 0)

## Removing midface and midface2 from data
mmc_data <- mmc_data[, -c(266, 267)]

## Renaming midface.true to midface
names(mmc_data)[names(mmc_data) == 'midface.true'] <- 'midface'

## Reinstering NA values
mmc_data[mmc_data==" "] <- NA

# --------------------

## Creating Injury.Mech.category for column J
mmc_data$Injury.Mech.category <- rep(NA,length(mmc_data$Injury.Mech))

for (i in 1:length(mmc_data$Injury.Mech)){
  if (str_detect(mmc_data$Injury.Mech[i],"Motorcycle|MVC")==TRUE){mmc_data$Injury.Mech.category[i]="MVC"}
  if (str_detect(mmc_data$Injury.Mech[i],"Fall")==TRUE){mmc_data$Injury.Mech.category[i]="Falls"}
  if (str_detect(mmc_data$Injury.Mech[i],"gun")==TRUE){mmc_data$Injury.Mech.category[i]="Gun"}
  if (str_detect(mmc_data$Injury.Mech[i],"Bicycle")==TRUE){mmc_data$Injury.Mech.category[i]="Bicycle"}
  if (str_detect(mmc_data$Injury.Mech[i],"Other|Assault|Biting|Pedestrian|Unknown|                                                                                                                                                                                                                                                                ")==TRUE){mmc_data$Injury.Mech.category[i]="Others"}
  if (str_detect(mmc_data$Injury.Mech[i],"Blunt Mechanism")==TRUE){mmc_data$Injury.Mech.category[i]="Other_Blunt"}
}

